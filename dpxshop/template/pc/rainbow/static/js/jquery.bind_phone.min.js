var RegLoginTabSetting={count:60,handle:undefined};function showBind(){$("#bindPhone").modal("show")}function countDown(){$(".btn-bind-sendvc").attr("disabled",true).html(RegLoginTabSetting.count+"秒后重发");RegLoginTabSetting.count-=1;if(RegLoginTabSetting.count==0){RegLoginTabSetting.count=60;$(".btn-bind-sendvc").removeAttr("disabled").html("重发验证码");$(".waitForVcode").fadeOut(500);clearInterval(RegLoginTabSetting.handle)}}function chCode(b){var a=$(".checkVcode");if(!(/^\d{6}$/.test(b))){a.fadeIn(1000).find(".checkVcodeTips").html("验证码不正确，请填入正确的验证码。");return false}else{a.hide()}return true}function initBindPhone(){$(".btn-bind-sendvc").click(function(b){b.preventDefault();$(".checkVcode").hide();$(".waitForVcode").hide();$(".checkMoblileNum").hide();var a=$("#bind_phone_number").val();if(a==undefined){a=$("span.text_orange").html()}if(!Check.mobile(a)){$(".checkMoblileNum").fadeIn(1000).find(".checkMoblileNumTips").html("手机号码不正确，请输入正确的11位手机号码。");return false}else{$.get("/userapi/checkphone",{phone:a},function(c){if(c.label!="success"){$(".checkMoblileNum").fadeIn(1000).find(".checkMoblileNumTips").html(c.brief);return false}else{$.post("/smsapi/gettickettow/?mobile="+a,function(d){if(d.label!="success"){$(".checkMoblileNum").fadeIn(1000).find(".checkMoblileNumTips").html(d.brief)}else{RegLoginTabSetting.handle=setInterval(countDown,1000);$(".waitForVcode").fadeIn(500)}})}});$(".checkMoblileNum").hide()}})}function ListenBindBtn(){$("#btn-bind").click(function(c){c.preventDefault();var a=$("#bind_phone_number").val();var b=$("#bind_vcode").val();if(!Check.mobile(a)){return}if(!chCode(b)){return}$.post("/userapi/bindPhone",{phone:a,ticket:b},function(d){if(d.label!="success"){showMsg("error",d.brief)}else{showMsg("success",d.brief);window.location.reload();$(".glyphicon-user").attr("isBindPhone",0)}})})};